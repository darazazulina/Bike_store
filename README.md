# Продажи магазина велосипедов

Инструменты: SQL, MySQL Workbench.

## Файлы

В проекте содержатся следующие файлы:

- create_table_bike.sql - создание таблиц базы данных
- questions_of_bike.sql - sql-запросы
- query_report.pdf - отчет о созданных запросах

## Исходные данные

Набор данных [Bike Store Relational Database](https://www.kaggle.com/datasets/dillonmyrick/bike-store-sample-database) размещен на kaggle.

Этот набор содержит информацию о заказах велосипедов, о продукции магазина, о клиентах, о сотрудниках, о магазинах и о наличии товара. В базе данных присутствует 9 таблиц.

### Таблицы

**1) store**
Таблица содержит информацию о магазине.

- store_id: уникальный последовательный идентификатор, представляющий отдельный магазин;
- store_name: название магазина;
- phone: номер телефона;
- email: адрес электронной почты;
- street: улица;
- city: город;
- state: штат;
- zip_code: индекс.

**2) staff**
Таблица хранит основную информацию о персонале.
Персонал работает в магазине, указанном значением в столбце store_id. В магазине может быть один или несколько сотрудников. Персонал подчиняется менеджеру магазина, указанному значением в столбце manager_id. Если значение в manager_id равно null, то персонал является топ-менеджером. Если сотрудник больше не работает ни в одном магазине, значение в активном столбце устанавливается равным нулю.

- staff_id: уникальный последовательный идентификатор, представляющий отдельного сотрудника;
- first_name: имя сотрудника;
- last_name: фамилия сотрудника;
- email: адрес электронной почты;
- phone: номер телефона;
- active: флаг активности сотрудника (1 - работает, 0 - не работает);
- store_id: идентификатор магазина;
- manager_id: идентификатор менеджера (руководящего сотрудника).

**3) categories**
В таблице категорий хранятся категории велосипедов, такие как детские велосипеды, велосипеды комфортного класса и электровелосипеды.

- category_id: уникальный последовательный идентификатор, представляющий отдельную категорию;
- category_name: название категории.

**4) brands**
В таблице брендов хранится информация о марках велосипедов.

- brand_id: уникальный последовательный идентификатор, представляющий отдельный бренд;
- brand_name: название бренда.

**5) products**
В таблице содержится информация о продукте.

Каждый продукт принадлежит бренду, указанному в столбце brand_id. Таким образом, бренд может иметь ноль или много продуктов. Каждый продукт также принадлежит категории, указанной в столбце category_id. Кроме того, каждая категория может иметь ноль или много продуктов.

- product_id: уникальный последовательный идентификатор, представляющий отдельный продукт;
- product_name: название продукта;
- brand_id: идентификатор бренда;
- category_id: идентификатор категории;
- model_year: год выпуска модели;
- list_price: цена продукта.

**6) customers**
В таблице хранится информация о клиенте.

- customer_id: уникальный последовательный идентификатор, представляющий отдельного клиента;
- first_name: имя клиента;
- last_name: фамилия клиента;
- phone: номер телефона;
- email; адрес электронной почты;
- street: улица;
- city: город;
- state: штат;
- zip_code: индекс.

**7) orders**
В таблице содержится информация о заказе продуктов магазина.

Для каждой записи присутствует информация о магазине, где была совершена транзакция, и персонале, совершившем транзакцию. Заказ на продажу имеет одну или несколько позиций, хранящихся в таблице order_items.

- order_id: уникальный последовательный идентификатор, представляющий отдельный заказ;
- customer_id: идентификатор клиента;
- order_status: статус заказа (1 = Ожидание; 2 = Обработка; 3 = Отклонено; 4 = Завершено);
- order_date: дата заказа;
- required_date: требуемая дата;
- shipped_date: дата отправления;
- store_id: идентификатор магазина;
- staff_id: идентификатор сотрудника.

**8) order_items**
Таблица хранит позиции заказа на продажу. Каждая позиция принадлежит заказу на продажу, указанному в столбце order_id.

- order_id: идентификатор заказа;
- item_id: позиция заказа;
- product_id: идентификатор продукта;
- quantity: количество;
- list_price: цена;
- discount: скидка.

**9) stocks**
Таблица включает информацию о наличии товаров (количество конкретного товара в конкретном магазине).

- store_id: идентификатор магазина;
- product_id: идентификатор продукта;
- quantity: количество продукта.

## SQL-запросы для выборки данных и анализа

В файле questions_of_bike.sql содержатся запросы для поиска данных по разным вопросам.

#### Начальные запросы

1. Список всех продуктов и соответствующих им брендов
2. Поиск активного персонала в каждом магазине
3. Полные сведения о клиенте
4. Количество продуктов для каждой категории
5. Количество заказов каждого клиента

#### Средние запросы

1. Общий объем продаж по каждому продукту
2. Количество заказов по статусу
3. Количество заказов для каждого клиента
4. Наличие продукции в магазинах
5. Доход каждого магазина

#### Сложные запросы

1. Ежемесячные продажи
2. Лучшие клиенты, потратившие наибольшее количество денег
3. Иерархия сотрудников
4. Эффективность продукта
5. Анализ местоположения клиентов

#### Оконные функции

1. Ранг товаров от дорогих товаров к дешевым
2. Количество заказов в день
3. Нумерование заказов пользователей
4. Время между заказами каждого пользователя
5. Среднее время между заказами каждого пользователя
6. Продуктивные продавцы
7. Количество первых и повторных заказов

## Выводы

В данном проекте созданы SQL-запросы с использованием фильтрации (WHERE), объединеий (JOIN), группировки (GROUP BY), агрегирующих функций (SUM, AVG, MIN, COUNT) и оконных функций (DENSE_RANK, ROW_NUMBER, LAG).
